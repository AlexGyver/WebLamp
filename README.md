# WebLamp
Парные лампы со связью через Интернет на esp8266
![sch](/schemes/scheme.png)

## Возможности
- Связь между двумя лампами через Интернет. Лампы управляют друг другом
- Включение/выключение, смена цвета, функция "подмигнуть"
- Управление яркостью (только локальной лампы)
- Веб-интерфейс для настройки
- Сенсорное управление
- ИК датчик движения

## Подключение
- При подаче питания начнётся подключение к роутеру (лампа мигает зелёным)
  - Если подключение не будет установлено за 15 секунд или юзер кликнет по кнопке, лампа запустит свою точку доступа WiFi (лампа мигает синим)
  - Точка называется **WLamp <ip адрес>**, где ip адрес - последний полученный от роутера адрес (успешное подключение)
  - При подключении к точке доступа должна автоматически открыться страница конфигурации (веб-интерфейс). Если не открылась - перейди в браузере по адресу **192.168.4.1**
  - При сохранении настроек ИЛИ при клике по кнопке лампа будет перезагружена и процесс подключения начнётся заново
- При успешном подключении лампа перейдёт в режим работы и включится настроенным цветом (если включена)
- Страница конфигурации лампы (веб-интерфейс) доступна в локальной сети роутера по IP адресу, который роутер выдал лампе. Чтобы его узнать, можно повторить процедуру подключения
![conn](/schemes/flowchart.png)

## Настройки
Нужно указать на странице конфигурации данные для подключения к роутеру, а также имя своей лампы (Local Name) и её удалённой пары (Remote Name)

## Управление
- 1 клик: вкл/выкл
- 2 клика: сменить цвет
- 3 клика: подмигнуть
- Удержание: сменить яркость

## Поведение лампы
- Удалённая лампа не в сети: локальная лампа горит ровным светом
- Удалённая лампа в сети: локальная лампа плавно "дышит" яркостью раз в секунду, тайм-аут 18 секунд
- Сработал ИК датчик на удалённой лампе: локальная лампа плавно "дышит" яркостью 3 раза в секунду, тайм-аут 60 секунд